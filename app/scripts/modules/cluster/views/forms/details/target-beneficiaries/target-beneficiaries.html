
<div class="row">
	<div class="col s12 m12 l12">
		<div class="card">
			<ul class="collection with-header">
				
				<li class="collection-header blue lighten-4">
					<h5 class="report-work-title">
						<i class="material-icons left">group</i><span class="beneficiary-count">{{ project.definition.target_beneficiaries | sumArrayByKeys:project.indicators:project.skip | number }}</span> People in Need
					</h5>
				</li>

				<li class="collection-item avatar">

					<div class="row">
						<div class="col s12 card">
							<div style="padding-top: 10px; padding-left: 40px;">
							  <table class="bordered responsive-table" ng-show="project.definition.target_beneficiaries.length">
							    <tr style="font-weight: 400">
							    	<td></td>
							      <td>Activity</td>
							      <td>Description</td>
							      <td ng-if="project.definition.cluster_id !== 'eiewg'">Category</td>
							      <td>Beneficiary</td>
							      <td ng-if="project.definition.cluster_id === 'eiewg'">Units</td>
							      <td ng-if="project.showCash()">Cash Amount</td>
<!-- 								  <td ng-if="project.definition.cluster_id === 'wash' || project.definition.cluster_id === 'esnfi'">Households</td> -->
							      <td ng-if="project.definition.cluster_id === 'wash' || project.definition.cluster_id === 'esnfi'">Families</td>
							      <td>Boys</td>
							      <td>Girls</td>
							      <td ng-if="project.definition.cluster_id !== 'eiewg' && project.definition.cluster_id !== 'nutrition'">Men</td>
							      <td ng-if="project.definition.cluster_id !== 'eiewg'">Women</td>
							      <td ng-if="project.definition.cluster_id !== 'eiewg' && project.definition.cluster_id !== 'nutrition'">Eld. Men</td>
							      <td ng-if="project.definition.cluster_id !== 'eiewg' && project.definition.cluster_id !== 'nutrition'">Eld. Women</td>
							      <td ng-if="project.definition.project_status !== 'complete'">Edit</td>
							    </tr>
							    <tr ng-repeat="beneficiary in project.definition.target_beneficiaries track by $index">
							    	<td>
							    		<i class="material-icons" style="color: teal;">group</i>
							    	</td>
							      <td>
							        <!-- editable activity_type from Project -->
							        <span e-form="rowform"
							        			e-name="activity_type_id"
							        			editable-select="beneficiary.activity_type_id"
												e-placeholder="Select..."
							        			e-ng-options="a_t.activity_type_id as a_t.activity_type_name for a_t in project.definition.activity_type"
							        			e-ng-disabled="!project.definition.activity_type.length">
							          {{ project.showActivity($data, beneficiary) }}
							        </span>
							      </td>
							      <td>
							        <!-- editable activity_description from Project -->
							        <span e-form="rowform"
							        			e-name="activity_description_id"
							        			editable-select="beneficiary.activity_description_id"
							        			e-placeholder="Select..."
							        			e-ng-options="a_d.activity_description_id as a_d.activity_description_name for a_d in project.lists.activity_descriptions | filter: { activity_type_id: beneficiary.activity_type_id }"
							        			e-ng-disabled="!beneficiary.activity_type_id">
							          {{ project.showDescription($data, beneficiary) }}
							        </span>
							      </td>
							      <td ng-show="project.definition.cluster_id !== 'eiewg'">
							        <!-- editable group (select-remote) -->
							        <span e-form="rowform"
							        			e-name="category_type_id"
							        			editable-select="beneficiary.category_type_id"
							        			e-placeholder="Select..."
							        			e-ng-options="b.category_type_id as b.category_type_name for b in project.lists.category_types | filter: { cluster_id: beneficiary.cluster_id }"
							        			e-ng-disabled="!beneficiary.activity_description_id">
							          {{ project.showCategory($data, beneficiary) }}
							        </span>
							      </td>
							      <td>
							        <!-- editable group (select-remote) -->
							        <span e-form="rowform"
							        			e-name="beneficiary_type_id"
							        			editable-select="beneficiary.beneficiary_type_id"
							        			e-placeholder="Select..."
							        			e-ng-options="b.beneficiary_type_id as b.beneficiary_type_name for b in project.lists.beneficiary_types | filter: { category_type_id: beneficiary.category_type_id, cluster_id: beneficiary.cluster_id }"
							        			e-ng-disabled="!beneficiary.category_type_id">
							          {{ project.showBeneficiary($data, beneficiary) }}
							        </span>
							      </td>
									<td ng-show="project.definition.cluster_id === 'eiewg'">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="units"
							        			editable-number="beneficiary.units"
							        			e-min="0"
							        			e-ng-change="project.updateInput($index, 'units', $data )"
							        			e-required>
							          {{ beneficiary.units }}
							        </span>
							      </td>
							      <td ng-show="project.showCash()">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="cash_amount"
							        			editable-number="beneficiary.cash_amount"
							        			e-min="0"
							        			e-ng-change="project.updateInput( $index, 'cash_amount', $data )"
							        			e-required>
							          {{ beneficiary.cash_amount }}
							        </span>
							      </td>
<!-- 							      <td ng-show="project.definition.cluster_id === 'wash' || project.definition.cluster_id === 'esnfi'"> -->
								  <td ng-show="false">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="households"
							        			editable-number="beneficiary.households"
							        			e-min="0"
							        			e-ng-change="project.updateInput( $index, 'households', $data )"
							        			e-required>
							          {{ beneficiary.households }}
							        </span>
							      </td>
							      <td ng-show="project.definition.cluster_id === 'wash' || project.definition.cluster_id === 'esnfi'">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="families"
							        			editable-number="beneficiary.families"
							        			e-min="0"
							        			e-ng-change="project.updateInput($index, 'families', $data )"
							        			e-required>
							          {{ beneficiary.families }}
							        </span>
							      </td>
							      <td>
							        <!-- editable number -->
							        <span e-form="rowform" 
							        			e-name="boys"
							        			editable-number="beneficiary.boys"
							        			e-min="0"
							        			e-ng-change="project.updateInput($index, 'boys', $data )"
							        			e-required>
							          {{ beneficiary.boys }}
							        </span>
							      </td>
							      <td>
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="girls"
							        			editable-number="beneficiary.girls"
							        			e-min="0"
							        			e-ng-change="project.updateInput($index, 'girls', $data )"
							        			e-required>
							          {{ beneficiary.girls }}
							        </span>
							      </td>
							      <td ng-show="project.definition.cluster_id !== 'eiewg' && project.definition.cluster_id !== 'nutrition'">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="men"
							        			editable-number="beneficiary.men"
							        			e-min="0"
							        			e-ng-change="project.updateInput($index, 'men', $data )"
							        			e-ng-disabled="beneficiary.activity_type_id === 'mch'"
							        			e-required>
							          {{ beneficiary.men }}
							        </span>
							      </td>
							      <td ng-show="project.definition.cluster_id !== 'eiewg'">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="women"
							        			editable-number="beneficiary.women"
							        			e-min="0"
							        			e-ng-change="project.updateInput($index, 'women', $data )"
							        			e-required>
							          {{ beneficiary.women }}
							        </span>
							      </td>
							      <td ng-show="project.definition.cluster_id !== 'eiewg' && project.definition.cluster_id !== 'nutrition'">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="elderly_men"
							        			editable-number="beneficiary.elderly_men"
							        			e-min="0" e-ng-change="project.updateInput($index, 'elderly_men', $data )"
							        			e-required>
							          {{ beneficiary.elderly_men }}
							        </span>
							      </td>
							      <td ng-show="project.definition.cluster_id !== 'eiewg' && project.definition.cluster_id !== 'nutrition'">
							        <!-- editable number -->
							        <span e-form="rowform"
							        			e-name="elderly_women"
							        			editable-number="beneficiary.elderly_women"
							        			e-min="0"
							        			e-ng-change="project.updateInput($index, 'elderly_women', $data )"
							        			e-required>
							          {{ beneficiary.elderly_women }}
							        </span>
							      </td>
							      
							      <td style="white-space: nowrap" ng-show="project.definition.project_status !== 'complete'" >
							        <!-- form -->
							        <form editable-form name="rowform" ng-show="rowform.$visible" onbeforesave="project.saveBeneficiary()" class="form-buttons form-inline" shown="inserted == beneficiary">
							          <button 
							          		title="Save" type="submit" class="btn waves-effect waves-light save"
							          		ng-if="rowform.$visible" 
							          		ng-disabled="
					                  	( ( !project.project_details_valid() ) ||
					                    ( !project.activity_type_valid() ) ||
					                    ( !project.project_donor_valid() ) ||
					                    ( !project.target_beneficiaries_valid() ) ||
					                    ( !project.target_locations_valid() ) ||
					                    ( !project.submit ) )">
							            <i class="material-icons">save</i>
							          </button>
							          <button type="button" ng-if="rowform.$visible" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn blue lighten-1 waves-effect waves-light" title="Cancel Edit">
													<i class="material-icons">clear</i>
							          </button>
							        </form>
							        <div class="buttons" ng-if="!rowform.$visible">
							          <button class="btn waves-effect waves-light" ng-click="rowform.$show()" title="Edit">
													<i class="material-icons">create</i>
							          </button>
							          <button class="btn red lighten-2 waves-effect waves-light" ng-click="project.removeBeneficiaryModal( $index )" title="Remove">
							          	<i class="material-icons">delete</i>
							          </button>
							        </div>  
							      </td>
							      
							    </tr>
							  </table>

							  <button class="btn" ng-show="project.definition.project_status !== 'complete'" ng-click="project.addBeneficiary()" style="margin:20px 0px;">
							  	<i class="material-icons left">add</i>Add Row
							  </button>

							</div>

						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
</div>
