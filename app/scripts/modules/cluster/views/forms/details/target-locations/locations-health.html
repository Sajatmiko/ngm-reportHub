
<script>

	// add init delay to load data
	setTimeout(function(){
	  // init selects
	  $( 'select' ).material_select();
	}, 10 );

</script>

<!-- bind html -->
<div class="row">
	<div class="col s12 m12 l12">
		<div class="card">
			<ul class="collection with-header">
				<li class="collection-header blue lighten-4">
					<h5 class="report-work-title">
						<i class="material-icons left">location_on</i>Project Target Locations
					</h5>
				</li>
				<li class="collection-item avatar">

					<div class="row">
					
						<div class="card" style="padding:20px;">

							<!-- form -->

				      <div class="row remove" ng-if="project.definition.project_status !== 'complete'">

			      		<div class="input-field col s12 m3"
			      			ng-class="{ 'error-label': healthProjectForm.$submitted
							  								&& project.definition.locations.length === 0 }">
			      			<select id="ngm-project-admin1" class="validate"
							    	ng-model="project.options.location.admin1"
							    	ng-model-options="{ trackBy: '$value.admin1pcode'}"
							    	ng-change="project.updateSelect()"
							    	ng-disabled="project.definition.project_status === 'complete'"
			      				ng-options="item as item.admin1name for item in project.options.list.admin1">
			      				<option value="" disabled selected>Choose {{ project.options.list.admin1[0].admin1type_name }}</option>
			      			</select>
			      			<label>{{ project.options.list.admin1[0].admin1type_name }}</label>
			      		</div>

			      		<div class="input-field col s12 m3"
			      			ng-class="{ 'error-label': healthProjectForm.$submitted
							  								&& project.definition.locations.length === 0 }">
			      			<select id="ngm-project-admin2" class="validate"
							    	ng-model="project.options.location.admin2"
							    	ng-model-options="{ trackBy: '$value.id'}"
							    	ng-change="project.updateSelect()"
							    	ng-disabled="!project.options.location.admin1"
			      				ng-options="item as item.admin2name for item in project.options.list.admin2 | filter: { admin1pcode: project.options.location.admin1.admin1pcode }">
			      				<option value="" disabled selected>Choose {{ project.options.list.admin2[0].admin2type_name }}</option>
			      			</select>
			      			<label>{{ project.options.list.admin2[0].admin2type_name }}</label>
			      		</div>

							  <div class="input-field col s12 m2"
							  	ng-class="{ 'error-label': healthProjectForm.$submitted
							  								&& project.definition.locations.length === 0 }">
							    <select id="ngm-project-hf_type" class="validate"
							    	ng-model="project.options.location.fac_type"
							    	ng-model-options="{ trackBy: '$value.fac_type'}"
							    	ng-disabled="!project.options.location.admin2"
							    	ng-options="item as item.fac_type_name for item in project.options.list.facility_type">
							      <option value="" disabled selected>Choose Facility Type</option>
							    </select>
							    <label>Facility Type</label>
							  </div>

							  <div class="input-field col s12 m3">
							    <input id="ngm-project-hf_name" type="text" class="validate"
							    	ng-model="project.options.location.fac_type.fac_name"
							    	ng-disabled="!project.options.location.fac_type">
							    <label for="ngm-project-hf_name">Facility Name</label>
							  </div>

			      		<div class="col s12 m1" style="padding-top:15px;">
			      			<button class="waves-effect waves-light btn-floating green lighten-2 right" 
			      					title="Add Location {{ project.options.location.fac_type.fac_name }}"
			      					ng-show="project.definition.project_status !== 'complete'"
			      					ng-click="project.addLocation()"
			      					ng-disabled="!project.options.location.fac_type.fac_name">
			      					<i class="material-icons">add</i>
			      			</button>
							  </div>					  

							 </div>

							 <div class="row" style="padding-left:40px;">

							 	<div class="row">
									<h5 class="report-selected-locations">{{ project.definition.target_locations.length }} Selected Locations</h5>
								</div>

								<div class="row" ng-repeat="location in project.definition.target_locations | orderBy: '-createdAt' track by $index">

									<div class="row" id="ngm-health-locations-{{ $index }}">
										<div class="col s12 m11 left">
								    	<!-- health cluster -->
								    	<h5 class="report-location-title">
														<i class="material-icons left" style="color: teal;">location_on</i>
														{{ location.admin1name }}, {{ location.admin2name }}, {{ location.fac_type_name }}, {{ location.fac_name }}
											</h5>
										</div>
										<div class="col s12 m1 right" style="padding-top:15px;padding-right:34px;">
											<a class="waves-effect waves-light btn-floating red lighten-2 right"
									      	title="Remove {{ location.admin1name }} Location {{ location.fac_name }}"
									      	ng-if="project.definition.project_status !== 'complete'"
									      	ng-click="project.removeLocationModal( $index )"><i class="material-icons">clear</i>
									    </a>
										</div>
									</div>

								</div>
								      	
				      </div>

			    	</div>

			    </div>

				</li>
			</ul>

		</div>
	</div>
</div>
